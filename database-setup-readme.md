# 物流トラブル管理システム データベースセットアップ

## 概要
開発用SQL Server環境でのデータベースセットアップ手順です。

## 接続情報
- **サーバー**: 10.194.2.38,1434
- **データベース名**: LTMDB
- **認証**: SQL Server認証
- **ユーザー名**: sa
- **パスワード**: Medicalsv@6087!!

## セットアップ手順

### 1. データベース接続確認
```sql
-- database-connection.sql を実行
```
データベースの存在確認と作成を行います。

### 2. テーブル作成
```sql
-- database-initialization.sql を実行
```
以下のテーブルを作成します：
- マスタテーブル群（7テーブル）
- ユーザー管理テーブル（2テーブル）
- メインデータテーブル（1テーブル）
- 監査・ログテーブル（2テーブル）

**合計: 12テーブル**

### 3. 初期データ投入
```sql
-- database-seed-data.sql を実行
```
以下の初期データを投入します：
- マスタデータ（部門、発生場所、倉庫、運送会社、トラブル区分等）
- 初期ユーザー（システム管理者、倉庫管理者、一般ユーザー）
- サンプルインシデントデータ

### 4. インデックス作成
```sql
-- database-indexes.sql を実行
```
パフォーマンス向上のためのインデックスを作成します。

## 統合セットアップ
```sql
-- database-setup.sql を実行
```
基本的なセットアップを行い、上記の手順を案内します。

## 作成されるテーブル一覧

### マスタテーブル群
1. 部門
2. 発生場所
3. 倉庫
4. 運送会社
5. トラブル区分
6. トラブル詳細区分
7. 単位

### ユーザー管理テーブル
1. ユーザー
2. ユーザーロール

### メインデータテーブル
1. インシデント

### 監査・ログテーブル
1. インシデント監査ログ
2. システムログ

## 初期ユーザー

### システム管理者
- **ユーザーID**: admin
- **パスワード**: （設定が必要）
- **アクセスレベル**: システム管理者
- **権限**: 全インシデントにアクセス可能

### 倉庫管理者
- **ユーザーID**: warehouse_manager_01
- **パスワード**: （設定が必要）
- **アクセスレベル**: 倉庫管理者
- **デフォルト倉庫**: 東京倉庫
- **権限**: 東京倉庫のインシデントのみアクセス可能

### 一般ユーザー
- **ユーザーID**: user_01
- **パスワード**: （設定が必要）
- **アクセスレベル**: 一般
- **権限**: 作成したインシデントのみアクセス可能

## 注意事項

1. **セキュリティ**: 本番環境では必ずパスワードを変更してください
2. **バックアップ**: 重要なデータは定期的にバックアップを取得してください
3. **権限管理**: ユーザーの権限は必要最小限に設定してください
4. **監査ログ**: 重要な操作は監査ログに記録されます

## トラブルシューティング

### 接続エラー
- サーバーのIPアドレスとポート番号を確認
- ファイアウォール設定を確認
- SQL Server認証が有効になっているか確認

### テーブル作成エラー
- 既存のテーブルとの競合を確認
- 権限不足の場合は管理者権限で実行

### データ投入エラー
- 外部キー制約エラーの場合は、マスタデータの投入順序を確認
- 重複データエラーの場合は、既存データを確認

## サポート
問題が発生した場合は、システム管理者に連絡してください。

